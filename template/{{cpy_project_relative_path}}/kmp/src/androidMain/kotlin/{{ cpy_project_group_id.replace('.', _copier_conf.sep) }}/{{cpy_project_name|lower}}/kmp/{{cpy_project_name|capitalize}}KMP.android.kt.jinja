package {{cpy_project_group_id}}.{{cpy_project_name|lower}}.kmp

/**
 * Android implementation of {{cpy_project_name|capitalize}}KMP
 *
 * This implementation uses JNI to bridge to the native C++ library.
 * The native library is loaded automatically when this class is first accessed.
 *
 * Note: The native library (lib{{cpy_project_name|lower}}.so) should be placed in
 * src/androidMain/jniLibs/<abi>/ before building.
 * You can build it using: ccgo build android
 */
actual class {{cpy_project_name|capitalize}}KMP actual constructor() {
    companion object {
        private const val LIBRARY_NAME = "{{cpy_project_name|lower}}"

        init {
            try {
                System.loadLibrary(LIBRARY_NAME)
            } catch (e: UnsatisfiedLinkError) {
                throw RuntimeException("Failed to load native library '$LIBRARY_NAME': ${e.message}", e)
            }
        }

        // Native JNI methods
        @JvmStatic
        private external fun nativeSetDebugLog(enable: Boolean)

        @JvmStatic
        private external fun nativeGetVersion(): String
    }

    actual fun setDebugLog(enable: Boolean) {
        nativeSetDebugLog(enable)
    }

    actual fun getVersion(): String {
        return nativeGetVersion()
    }

    actual fun getPlatformName(): String {
        return "Android (API ${android.os.Build.VERSION.SDK_INT})"
    }
}
